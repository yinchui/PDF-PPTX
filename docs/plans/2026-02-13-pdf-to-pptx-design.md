# PDF转PPTX网页应用设计

## 1. 核心功能

用户上传PDF文件 → 浏览器解析PDF → 提取文字/图片/形状 → 生成PPTX下载

## 2. 技术架构

### 技术栈
- 单页应用（SPA）
- **pdf.js** - PDF解析和渲染
- **pptxgenjs** - 客户端生成PPTX文件
- **Tailwind CSS** - 样式

### 文件处理流程
```
用户上传PDF → pdf.js解析 → 提取页面元素 → pptxgenjs生成PPTX → 文件下载
```

## 3. 页面结构

```
+-------------------------------------+
|           Header (Logo)              |
+-------------------------------------+
|                                     |
|         上传区域 (拖拽+点击)         |
|                                     |
+-------------------------------------+
|         预览区域 (PDF页面列表)       |
|         [页1] [页2] [页3] ...       |
+-------------------------------------+
|    [转换按钮]          进度条        |
+-------------------------------------+
|           下载按钮                   |
+-------------------------------------+
```

## 4. 关键模块

| 模块 | 功能 |
|------|------|
| PDFUploader | 处理文件上传，支持拖拽和点击 |
| PDFRenderer | 渲染PDF页面为预览图 |
| PDFExtractor | 提取每页的文字、坐标、图片 |
| PPTXGenerator | 将提取内容转换为PPTX |
| DownloadManager | 处理文件下载 |

## 5. 元素提取策略

| 元素 | 提取方式 |
|------|----------|
| 文字 | pdf.js getTextContent() 获取文本和位置 |
| 图片 | pdf.js getObject() 提取图像流 |
| 背景色/矩形 | 分析页面渲染结果，检测色块 |

## 6. 错误处理

- **非PDF文件** → 提示"请上传PDF文件"
- **PDF解析失败** → 提示"文件损坏或格式不支持"
- **生成失败** → 提示"转换失败，请重试"
- **文件过大** → 提示"文件过大，建议分页处理"

## 7. 验收标准

- [ ] 可以上传PDF文件并显示预览
- [ ] 可以将PDF转换为PPTX并下载
- [ ] 转换后的PPTX可以用PowerPoint/WPS打开
- [ ] 文字基本可编辑
- [ ] 基本的排版能保留
